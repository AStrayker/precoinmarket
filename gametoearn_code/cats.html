<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Редактирование контента</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCd-Kf5smC-xTCksRRFSOBQmpKsegX6lPQ",
            authDomain: "precoinmarket-8af8e.firebaseapp.com",
            databaseURL: "https://precoinmarket-8af8e-default-rtdb.firebaseio.com",
            projectId: "precoinmarket-8af8e",
            storageBucket: "precoinmarket-8af8e.appspot.com",
            messagingSenderId: "11819212336",
            appId: "1:11819212336:web:0ea96456065f66ecca17f5",
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        async function loadContent(identifier = 'content') {
            const contentRef = ref(database, identifier);
            const snapshot = await get(contentRef);
            const data = snapshot.val();
            document.getElementById('contentEditable').innerHTML = data ? data.text : '';
        }

        async function saveContent(identifier = 'content') {
            const newContent = document.getElementById('contentEditable').innerHTML;
            const contentRef = ref(database, identifier);
            await set(contentRef, { text: newContent });
            alert('Контент сохранен!');
            toggleEdit(false);
        }

        function authorizeEdit() {
            const password = prompt("Введите пароль для редактирования:");
            if (password === "09101998") {
                toggleEdit(true);
            } else {
                alert("Неверный пароль");
            }
        }

        function toggleEdit(isEditing) {
            document.getElementById('contentEditable').contentEditable = isEditing;
            document.getElementById('toolbar').style.display = isEditing ? 'flex' : 'none';
            document.getElementById('editButton').style.display = isEditing ? 'none' : 'inline-block';
            document.getElementById('saveButton').style.display = isEditing ? 'inline-block' : 'none';
            document.getElementById('cancelButton').style.display = isEditing ? 'inline-block' : 'none';
        }

        function applyFormatting(command, value = null) {
            document.execCommand(command, false, value);
        }

        function openImageModal() {
            document.getElementById('imageModal').style.display = 'block';
        }

        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
        }

        function insertImageWithSize() {
            const url = document.getElementById('imageUrl').value;
            const width = document.getElementById('imageWidth').value || "auto";
            const height = document.getElementById('imageHeight').value || "auto";
            if (url) {
                const imgHTML = `<img src="${url}" style="width:${width}; height:${height};">`;
                document.execCommand('insertHTML', false, imgHTML);
            }
            closeImageModal();
        }

        window.onload = () => loadContent();
        window.saveContent = saveContent;
        window.authorizeEdit = authorizeEdit;
        window.applyFormatting = applyFormatting;
        window.openImageModal = openImageModal;
        window.closeImageModal = closeImageModal;
        window.insertImageWithSize = insertImageWithSize;
    </script>
    <style>
        /* Общие стили */
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { text-align: center; }
        
        /* Стиль обложки */
        .cover {
            background-color: #00AEEF;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            border-radius: 10px;
            max-width: 600px;
            margin: 20px auto;
        }

        /* Аватар */
        .avatar {
            width: 80px;
            height: 80px;
            background-color: #000;
            border-radius: 5px;
            margin-right: 15px;
        }

        /* Название страницы */
        .page-name {
            font-size: 24px;
            font-weight: bold;
        }

        /* Иконки соцсетей */
        .social-icons {
            display: flex;
            gap: 10px;
        }
        .social-icon {
            width: 35px;
            height: 35px;
            border: 2px solid red;
            border-radius: 5px;
            overflow: hidden;
        }
        .social-icon img {
            width: 100%;
            height: 100%;
        }

        /* Редактирование контента */
        #contentEditable {
            padding: 10px;
            border: 1px solid #ccc;
            min-height: 200px;
            outline: none;
            margin-top: 20px;
        }
        #toolbar {
            display: none;
            justify-content: space-between;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            padding: 5px;
            margin-bottom: 10px;
        }
        #toolbar button { margin-right: 5px; }
        
        /* Модальное окно */
        #imageModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 300px;
            z-index: 1000;
        }
        #imageModal label { display: block; margin-top: 10px; }
        #imageModal input { width: 100%; padding: 5px; margin-top: 5px; }
    </style>
</head>
<body>

    <!-- Обложка -->
    <div class="cover">
        <div style="display: flex; align-items: center;">
            <div class="avatar"></div>
            <div class="page-name">Название страницы</div>
        </div>
        <div class="social-icons">
            <a href="https://www.facebook.com" class="social-icon"><img src="https://www.facebook.com/favicon.ico" alt="Facebook"></a>
            <a href="https://www.twitter.com" class="social-icon"><img src="https://www.twitter.com/favicon.ico" alt="Twitter"></a>
        </div>
    </div>

    <!-- Редактируемая форма -->
    <h1>Редактирование контента</h1>
    <div id="toolbar">
        <button onclick="applyFormatting('bold')">Жирный</button>
        <button onclick="applyFormatting('italic')">Курсив</button>
        <button onclick="applyFormatting('underline')">Подчеркнутый</button>
        <button onclick="openImageModal()">Вставить изображение</button>
    </div>
    <div id="contentEditable" contenteditable="false"></div>
    
    <!-- Управляющие кнопки -->
    <div>
        <button id="editButton" onclick="authorizeEdit()">Редактировать</button>
        <button id="saveButton" onclick="saveContent()">Сохранить</button>
        <button id="cancelButton" onclick="toggleEdit(false)">Отмена</button>
    </div>

    <!-- Модальное окно для вставки изображения -->
    <div id="imageModal">
        <h3>Вставка изображения</h3>
        <label for="imageUrl">URL изображения:</label>
        <input type="text" id="imageUrl" placeholder="https://example.com/image.jpg">
        <label for="imageWidth">Ширина (px):</label>
        <input type="text" id="imageWidth">
        <label for="imageHeight">Высота (px):</label>
        <input type="text" id="imageHeight">
        <button onclick="insertImageWithSize()">Применить</button>
        <button onclick="closeImageModal()">Закрыть</button>
    </div>

</body>
</html>
